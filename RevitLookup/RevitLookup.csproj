<?xml version="1.0" encoding="utf-8"?>
<Project Sdk="Microsoft.NET.Sdk.WindowsDesktop" ToolsVersion="15.0">
    <PropertyGroup>
        <AssemblyName>RevitLookup</AssemblyName>
        <TargetFramework>net48</TargetFramework>
        <OutputType>Library</OutputType>
        <PlatformTarget>x64</PlatformTarget>
        <Platforms>x64</Platforms>
        <UseWpf>true</UseWpf>
        <UseWindowsForms>true</UseWindowsForms>
        <GenerateAssemblyInfo>false</GenerateAssemblyInfo>
        <AppendTargetFrameworkToOutputPath>false</AppendTargetFrameworkToOutputPath>
        <LangVersion>9</LangVersion>
    </PropertyGroup>
    <PropertyGroup Condition=" '$(Configuration)|$(Platform)' == 'Debug|x64' ">
        <OutputPath>bin\Debug\</OutputPath>
    </PropertyGroup>
    <PropertyGroup Condition=" '$(Configuration)|$(Platform)' == 'Release|x64' ">
        <OutputPath>bin\Release\</OutputPath>
    </PropertyGroup>
    <ItemGroup>
        <PackageReference Include="JetBrains.Annotations">
            <Version>2021.2.0</Version>
        </PackageReference>
        <PackageReference Include="Revit_API_x64" Version="2022.0.0"/>
    </ItemGroup>
    
    <ItemGroup>
        <Resource Include="Resources\RLookup-16.ico" />
        <Resource Include="Resources\RLookup-16.png" />
        <Resource Include="Resources\RLookup-32.png" />
    </ItemGroup>

    <ItemGroup>
        <None Update="RevitLookup.addin">
            <CopyToOutputDirectory>PreserveNewest</CopyToOutputDirectory>
        </None>
    </ItemGroup>

    <ItemGroup>
        <AddinDll Include="$(TargetDir)$(AssemblyName).dll"/>
    </ItemGroup>
    
    <Target Name="AfterBuildTarget" AfterTargets="CoreBuild">
        <PropertyGroup>
            <AddinDir>bin\AddIn 2022 $(Configuration)\</AddinDir>
            <OutAddinDir>$(AddinDir)$(AssemblyName)\</OutAddinDir>
        </PropertyGroup>
        
        <Copy SourceFiles="$(TargetDir)$(AssemblyName).addin" DestinationFolder="$(AddinDir)"/>
        <Copy SourceFiles="@(AddinDll)" DestinationFolder="$(OutAddinDir)"/>

        <ItemGroup>
            <OutLibPath Include="$(AddinDir)**\*.*"/>
        </ItemGroup>
        <Copy SourceFiles="@(OutLibPath)" DestinationFolder="$(AppData)\Autodesk\Revit\Addins\2022\%(RecursiveDir)"/>
        
<!--        <Exec Command="rem copy Y:\a\src\rvt\RevitLookup\CS\bin\Debug\RevitLookup.dll C:\Users\jta\AppData\Roaming\Autodesk\Revit\Addins\2022&#xD;&#xA;rem copy Y:\a\src\rvt\RevitLookup\CS\RevitLookup.addin C:\Users\jta\AppData\Roaming\Autodesk\Revit\Addins\2022" />-->
    </Target>
</Project>
